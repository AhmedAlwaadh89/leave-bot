# نظام تجديد الرصيد الشهري

## الوصف
تم إضافة نظام آلي لتجديد رصيد الإجازات شهرياً لجميع الموظفين.

## الميزات

### 1. الرصيد الشهري الافتراضي
- كل موظف لديه رصيد شهري افتراضي:
  - **2 يوم** إجازة يومية شهرياً
  - **4 ساعات** إجازة ساعية شهرياً
  
### 2. التجديد التلقائي
- يتم تجديد الرصيد **تلقائياً** في أول كل شهر عند الساعة 00:01
- يُضاف الرصيد الشهري إلى الرصيد الحالي (يتراكم)
- التجديد يشمل فقط الموظفين ذوي الحالة "نشط" (approved)

### 3. إدارة الرصيد الشهري
يمكن للمدير تخصيص الرصيد الشهري لكل موظف من خلال:
- واجهة الويب > إدارة الموظفين
- يمكن تعديل الرصيد الشهري لكل موظف بشكل مستقل

## الملفات المعدلة

1. **database.py**
   - إضافة حقلين جديدين: `monthly_daily_leave_quota` و `monthly_hourly_leave_quota`
   - تحديث migration script

2. **scheduler.py** (جديد)
   - جدولة تجديد الرصيد الشهري
   - دالة `renew_monthly_leave_balance()` لتنفيذ التجديد

3. **bot.py**
   - تشغيل الـ scheduler في خلفية البوت

4. **app.py**
   - تحديث دالة `update_user` لحفظ الرصيد الشهري

5. **templates/employees.html**
   - إضافة عمودين للرصيد الشهري

6. **requirements.txt**
   - إضافة مكتبة `schedule`

## التشغيل

### تحديث قاعدة البيانات
قام النظام بتحديث قاعدة البيانات تلقائياً عند التشغيل الأول.

### تثبيت المكتبات الجديدة
```bash
pip install -r requirements.txt
```

أو مباشرة:
```bash
pip install schedule
```

### اختبار التجديد اليدوي
لاختبار تجديد الرصيد يدوياً:
```bash
python scheduler.py
```

## ملاحظات

- الرصيد يتراكم شهرياً (لا يُستبدل، بل يُضاف)
- يمكن للمدير تعديل الرصيد الشهري لكل موظف بشكل منفصل
- الموظفون في حالة "pending" لا يحصلون على رصيد شهري
- يتم تسجيل جميع عمليات التجديد في logs البوت
